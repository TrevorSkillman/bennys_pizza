<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Benny's Pizza</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div class="header">
        <h1>Welcome to Benny's Pizza on Route 715!</h1>
        <p>Phone Number goes here.</p>
        <p>Dine-in - Take-out - Catering - Deliveries - Parties</p>
    </div>

    <div class="nav">
        <div id="button-banner">
            <a class="button" onclick="loadSection('starters')">Starters</a>
            <a class="button" onclick="loadSection('pizza')">Pizza</a>
            <a class="button" onclick="loadSection('strombolis')">Strombolis</a>
            <a class="button" onclick="loadSection('subs')">Subs</a>
            <a class="button" onclick="loadSection('meals')">Meals</a>
            <a class="button" onclick="loadSection('desserts')">Desserts</a>
            <a class="button" onclick="loadSection('catering')">Catering</a>
        </div>
    </div>

    <div id="content-area">
        <div id="menu-content"></div>
    </div>

    <div class="footer">
        <div class="footer-section left">
            <p>1523 Route 715, Stroudsburg, PA 18360</p>
        </div>
        <div class="footer-section center">
            <img src="{{ url_for('static', filename='mastercar_logo.png') }}" alt="Mastercard Logo" style="height: 40px; margin-right: 10px;">
            <img src="{{ url_for('static', filename='visa_logo.png') }}" alt="Visa Logo" style="height: 40px;">
        </div>
        <div class="footer-section right">
            <div><a href="https://www.facebook.com/bennyspizza715/" target="_blank">Like us on Facebook!</a></div>
        </div>
    </div>

    <script>
        function loadSection(section) {
            console.log('Loading section:', section); // Debugging
            const url = `/menu/${section}`;
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    console.log('Loaded section data:', data); // Debugging
                    const menuContent = document.getElementById('menu-content');
                    menuContent.innerHTML = ''; // Clear current content
    
                    if (section === 'desserts' || section === 'catering' || section === 'strombolis') {
                        displayItems(data);
                    } else {
                        data.forEach(cat => {
                            const subcategoryDiv = document.createElement('div');
                            subcategoryDiv.textContent = cat.name;
                            subcategoryDiv.onclick = function() { loadItems(cat.id, cat.name); }; // Pass category name
                            subcategoryDiv.classList.add('button');
                            menuContent.appendChild(subcategoryDiv);
                        });
                    }
                })
                .catch(error => console.error('Error:', error));
        }
    
        function loadItems(categoryId, categoryName) {
            console.log('Loading items for category ID:', categoryId, 'Category Name:', categoryName); // Debugging
            const url = `/menu/items/${categoryId}`;
            fetch(url)
                .then(response => response.json())
                .then(items => {
                    console.log('Fetched items:', items); // Debugging
                    const menuContent = document.getElementById('menu-content');
                    menuContent.innerHTML = ''; // Clear current content
    
                    // Checking if the category is Wings to add sauces section
                    if (categoryName === 'Wings') {
                        console.log('Adding sauces section'); // Debugging
                        const saucesHeader = document.createElement('h3');
                        saucesHeader.textContent = 'Sauces';
                        menuContent.appendChild(saucesHeader);
    
                        const sauces = ['Hot', 'Mild', 'BBQ', 'Honey Hot', 'Honey BBQ', 'Honey Mustard', 'Sweet Chili', 'Garlic Parmesan', 'Old Bay Hot'];
                        const saucesDiv = document.createElement('div');
                        saucesDiv.classList.add('sauces');
    
                        sauces.forEach(sauce => {
                            const sauceItem = document.createElement('p');
                            sauceItem.textContent = sauce;
                            saucesDiv.appendChild(sauceItem);
                        });
    
                        menuContent.appendChild(saucesDiv);
                    }
                    displayItems(items);
                })
                .catch(error => console.error('Error:', error));
        }
    
        function displayItems(items) {
            console.log('Displaying items:', items); // Debugging
            const menuContent = document.getElementById('menu-content');
            menuContent.innerHTML = ''; // Clear current content
    
            items.forEach(item => {
                const itemContainer = document.createElement('div');
                itemContainer.classList.add('menu-item');
    
                const itemName = document.createElement('h3');
                itemName.textContent = item.name;
                itemContainer.appendChild(itemName);
    
                // adding descriptions
                const itemDescription = document.createElement('p');
                itemDescription.textContent = item.description;
                itemContainer.appendChild(itemDescription);
    
                if (item.sizes) {
                    try {
                        const sizes = JSON.parse(item.sizes);
                        const sizesContainer = document.createElement('div'); // creating a container for sizes
                        sizesContainer.classList.add('sizes-container'); // Adding a class for size of card
                        for (const [size, price] of Object.entries(sizes)) {
                            const sizeCard = document.createElement('div');
                            sizeCard.classList.add('size-card'); // Added class for individual size card
                            sizeCard.textContent = `${size}: $${price.toFixed(2)}`;
                            sizesContainer.appendChild(sizeCard);
                        }
                        itemContainer.appendChild(sizesContainer);
                    } catch (e) {
                        console.error('Error parsing sizes:', e);
                    }
                } else {
                    const price = document.createElement('p');
                    price.textContent = item.price === null ? 'Market Price' : `$${item.price.toFixed(2)}`;
                    itemContainer.appendChild(price);
                }
                menuContent.appendChild(itemContainer);
            });
        }
    </script>
</body>
</html>
